<?xml version="1.0" encoding="UTF-8"?>
<views:BaseContentPage  xmlns:views="clr-namespace:InterTwitter.Views"
                        xmlns="http://xamarin.com/schemas/2014/forms"
                        xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
                        xmlns:ffimageloading="clr-namespace:FFImageLoading.Forms;assembly=FFImageLoading.Forms"
                        xmlns:local="clr-namespace:InterTwitter.Enums" 
                        xmlns:fftransformations="clr-namespace:FFImageLoading.Transformations;assembly=FFImageLoading.Transformations"
                        xmlns:videoplayer="clr-namespace:Octane.Xamarin.Forms.VideoPlayer;assembly=Octane.Xamarin.Forms.VideoPlayer"
                        x:Class="InterTwitter.Views.HomePage"
                        NavigationPage.HasNavigationBar="False"
                        IconImageSource="{Binding Icon}">
    
    <views:BaseContentPage.Resources>

        <ResourceDictionary>

            <Style x:Key="ImageAvatarStyle" TargetType="ffimageloading:CachedImage">
                <Setter Property="Grid.Row" 
                        Value="0"/>
                <Setter Property="Grid.Column" 
                        Value="0"/>
                <Setter Property="Grid.RowSpan" 
                        Value="2"/>
                <Setter Property="Margin" 
                        Value="10,0,10,0"/>
                <Setter Property="VerticalOptions" 
                        Value="Start"/>
                <Setter Property="HorizontalOptions" 
                        Value="Center"/>
                <Setter Property="DownsampleToViewSize" 
                        Value="true"/>
                <Setter Property="Aspect" 
                        Value="AspectFit"/>
                <Setter Property="HeightRequest" 
                        Value="70"/>
                <Setter Property="WidthRequest" 
                        Value="70"/>
            </Style>

            <Style x:Key="boxViewSeparator" TargetType="BoxView">
                <Setter Property="Grid.Row" 
                        Value="2"/>
                <Setter Property="Grid.ColumnSpan" 
                        Value="2"/>
                <Setter Property="HorizontalOptions"
                        Value="Fill"/>
                <Setter Property="VerticalOptions" 
                        Value="Fill"/>
                <Setter Property="Color" 
                        Value="#DEDFE1"/>
            </Style>

            <Style x:Key="boxViewPoint" TargetType="BoxView">
                <Setter Property="HeightRequest" 
                        Value="3"/>
                <Setter Property="VerticalOptions"
                        Value="Center"/>
                <Setter Property="WidthRequest" 
                        Value="3"/>
                <Setter Property="CornerRadius"
                        Value="1.5"/>
                <Setter Property="BackgroundColor"
                        Value="DarkGray"/>
            </Style>

            <DataTemplate x:Key="OwlOneImageTemplate">

                <Grid Margin="10">

                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="70" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="1"/>
                    </Grid.RowDefinitions>

                    <ffimageloading:CachedImage Source="{Binding AuthorAvatar}"
                                                Style="{StaticResource ImageAvatarStyle}">

                        <ffimageloading:CachedImage.Transformations>

                            <fftransformations:CircleTransformation/>

                        </ffimageloading:CachedImage.Transformations>

                    </ffimageloading:CachedImage>

                    <StackLayout Grid.Row="0"
                                 Grid.Column="1"
                                 Margin="0, 10, 0, 0">

                        <Label Text="{Binding AuthorNickName}"
                               TextColor="#02060E"
                               FontSize="Large"/>

                        <Label Text="{Binding Text}"
                               TextColor="#02060E"/>

                        <ffimageloading:CachedImage Source="{Binding PostPhoto}"
                                                    HeightRequest="250">
                            <ffimageloading:CachedImage.Transformations>

                                <fftransformations:CornersTransformation CornersTransformType="AllRounded"
                                                                         BottomLeftCornerSize="5"
                                                                         TopLeftCornerSize="5"
                                                                         BottomRightCornerSize="5"
                                                                         TopRightCornerSize="5"/>

                            </ffimageloading:CachedImage.Transformations>

                        </ffimageloading:CachedImage>

                        <StackLayout Orientation="Horizontal">

                            <Label Text="{Binding PostDate}"
                                   TextColor="#66696E"/>

                            <BoxView Style="{StaticResource boxViewPoint}"/>

                            <Label Text="{Binding PostTime}"
                                   TextColor="#66696E"/>

                        </StackLayout>

                    </StackLayout>

                    <BoxView Style="{StaticResource boxViewSeparator}"/>

                </Grid>

            </DataTemplate>

            <DataTemplate x:Key="OwlFewImageTemplate">

                <Grid Margin="10">

                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="70" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="1"/>
                    </Grid.RowDefinitions>

                    <ffimageloading:CachedImage Source="{Binding AuthorAvatar}"
                                                Style="{StaticResource ImageAvatarStyle}">

                        <ffimageloading:CachedImage.Transformations>

                            <fftransformations:CircleTransformation/>

                        </ffimageloading:CachedImage.Transformations>

                    </ffimageloading:CachedImage>

                    <StackLayout Grid.Row="0"
                                 Grid.Column="1">

                        <Label Text="{Binding AuthorNickName}"
                               TextColor="#02060E"
                               FontSize="Large"/>

                        <Label Text="{Binding Text}"
                               TextColor="#02060E"/>

                        <StackLayout Orientation="Horizontal">

                            <ffimageloading:CachedImage Source="{Binding PostPhotoOne}"
                                                        HeightRequest="80"
                                                        WidthRequest="80">

                                <ffimageloading:CachedImage.Transformations>

                                    <fftransformations:CornersTransformation CornersTransformType="AllRounded"
                                                                             BottomLeftCornerSize="5"
                                                                             TopLeftCornerSize="5"
                                                                             BottomRightCornerSize="5"
                                                                             TopRightCornerSize="5"/>

                                </ffimageloading:CachedImage.Transformations>

                            </ffimageloading:CachedImage>

                            <ffimageloading:CachedImage Source="{Binding PostPhotoTwo}"
                                                        HeightRequest="80"
                                                        WidthRequest="80">

                                <ffimageloading:CachedImage.Transformations>

                                    <fftransformations:CornersTransformation CornersTransformType="AllRounded"
                                                                             BottomLeftCornerSize="5"
                                                                             TopLeftCornerSize="5"
                                                                             BottomRightCornerSize="5"
                                                                             TopRightCornerSize="5"/>

                                </ffimageloading:CachedImage.Transformations>

                            </ffimageloading:CachedImage>

                            <ffimageloading:CachedImage Source="{Binding PostPhotoThree}"
                                                        HeightRequest="80"
                                                        WidthRequest="80">

                                <ffimageloading:CachedImage.Transformations>

                                    <fftransformations:CornersTransformation CornersTransformType="AllRounded"
                                                                             BottomLeftCornerSize="5"
                                                                             TopLeftCornerSize="5"
                                                                             BottomRightCornerSize="5"
                                                                             TopRightCornerSize="5"/>

                                </ffimageloading:CachedImage.Transformations>

                            </ffimageloading:CachedImage>

                        </StackLayout>

                        <StackLayout Orientation="Horizontal">

                            <Label Text="{Binding PostDate}"
                                   TextColor="#66696E"/>

                            <BoxView Style="{StaticResource boxViewPoint}"/>

                            <Label Text="{Binding PostTime}"
                                   TextColor="#66696E"/>

                        </StackLayout>

                    </StackLayout>

                    <BoxView Style="{StaticResource boxViewSeparator}"/>

                </Grid>

            </DataTemplate>

            <DataTemplate x:Key="OwlAlbumTemplate">

                <Grid Margin="10">

                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="70" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="1" />
                    </Grid.RowDefinitions>

                    <ffimageloading:CachedImage Source="{Binding AuthorAvatar}"
                                                Style="{StaticResource ImageAvatarStyle}">

                        <ffimageloading:CachedImage.Transformations>

                            <fftransformations:CircleTransformation/>

                        </ffimageloading:CachedImage.Transformations>

                    </ffimageloading:CachedImage>

                    <StackLayout Grid.Row="0"
                                 Grid.Column="1">

                        <Label Text="{Binding AuthorNickName}"
                               TextColor="#02060E"
                               FontSize="Large"/>

                        <Label Text="{Binding Text}"
                               TextColor="#02060E"/>

                        <StackLayout Orientation="Horizontal">

                            <ffimageloading:CachedImage Source="{Binding PostPhotoOne}"
                                                        HeightRequest="80"
                                                        WidthRequest="80">

                                <ffimageloading:CachedImage.Transformations>

                                    <fftransformations:CornersTransformation CornersTransformType="AllRounded"
                                                                             BottomLeftCornerSize="5"
                                                                             TopLeftCornerSize="5"
                                                                             BottomRightCornerSize="5"
                                                                             TopRightCornerSize="5"/>

                                </ffimageloading:CachedImage.Transformations>

                            </ffimageloading:CachedImage>

                            <ffimageloading:CachedImage Source="{Binding PostPhotoTwo}"
                                                        HeightRequest="80"
                                                        WidthRequest="80">

                                <ffimageloading:CachedImage.Transformations>

                                    <fftransformations:CornersTransformation CornersTransformType="AllRounded"
                                                                             BottomLeftCornerSize="5"
                                                                             TopLeftCornerSize="5"
                                                                             BottomRightCornerSize="5"
                                                                             TopRightCornerSize="5"/>

                                </ffimageloading:CachedImage.Transformations>

                            </ffimageloading:CachedImage>

                            <ffimageloading:CachedImage Source="{Binding PostPhotoThree}"
                                                        HeightRequest="80"
                                                        WidthRequest="80">

                                <ffimageloading:CachedImage.Transformations>

                                    <fftransformations:CornersTransformation CornersTransformType="AllRounded"
                                                                             BottomLeftCornerSize="5"
                                                                             TopLeftCornerSize="5"
                                                                             BottomRightCornerSize="5"
                                                                             TopRightCornerSize="5"/>

                                </ffimageloading:CachedImage.Transformations>

                            </ffimageloading:CachedImage>

                        </StackLayout>

                        <StackLayout Orientation="Horizontal">

                            <ffimageloading:CachedImage Source="{Binding PostPhotoFour}"
                                                        HeightRequest="80"
                                                        WidthRequest="80">

                                <ffimageloading:CachedImage.Transformations>

                                    <fftransformations:CornersTransformation CornersTransformType="AllRounded"
                                                                             BottomLeftCornerSize="5"
                                                                             TopLeftCornerSize="5"
                                                                             BottomRightCornerSize="5"
                                                                             TopRightCornerSize="5"/>

                                </ffimageloading:CachedImage.Transformations>

                            </ffimageloading:CachedImage>

                            <ffimageloading:CachedImage Source="{Binding PostPhotoFive}"
                                                        HeightRequest="80"
                                                        WidthRequest="80">

                                <ffimageloading:CachedImage.Transformations>

                                    <fftransformations:CornersTransformation CornersTransformType="AllRounded"
                                                                             BottomLeftCornerSize="5"
                                                                             TopLeftCornerSize="5"
                                                                             BottomRightCornerSize="5"
                                                                             TopRightCornerSize="5"/>

                                </ffimageloading:CachedImage.Transformations>

                            </ffimageloading:CachedImage>

                            <ffimageloading:CachedImage Source="{Binding PostPhotoSix}"
                                                        HeightRequest="80"
                                                        WidthRequest="80">

                                <ffimageloading:CachedImage.Transformations>

                                    <fftransformations:CornersTransformation CornersTransformType="AllRounded"
                                                                             BottomLeftCornerSize="5"
                                                                             TopLeftCornerSize="5"
                                                                             BottomRightCornerSize="5"
                                                                             TopRightCornerSize="5"/>

                                </ffimageloading:CachedImage.Transformations>

                            </ffimageloading:CachedImage>

                        </StackLayout>

                        <StackLayout Orientation="Horizontal">

                            <Label Text="{Binding PostDate}"
                                   TextColor="#66696E"/>

                            <BoxView Style="{StaticResource boxViewPoint}"/>

                            <Label Text="{Binding PostTime}"
                                   TextColor="#66696E"/>

                        </StackLayout>

                    </StackLayout>

                    <BoxView Style="{StaticResource boxViewSeparator}"/>
                    
                </Grid>

            </DataTemplate>

            <DataTemplate x:Key="OwlNoMediaTemplate">

                <Grid Margin="10">

                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="70" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="1" />
                    </Grid.RowDefinitions>

                    <ffimageloading:CachedImage Source="{Binding AuthorAvatar}"
                                                Style="{StaticResource ImageAvatarStyle}">

                        <ffimageloading:CachedImage.Transformations>

                            <fftransformations:CircleTransformation/>

                        </ffimageloading:CachedImage.Transformations>

                    </ffimageloading:CachedImage>

                    <StackLayout Grid.Row="0"
                                 Grid.Column="1"
                                 Margin="0, 10, 0, 0">

                        <Label Text="{Binding AuthorNickName}"
                               TextColor="#02060E"
                               FontSize="Large"/>

                        <Label Text="{Binding Text}"
                               TextColor="#02060E"/>

                        <StackLayout Orientation="Horizontal">

                            <Label Text="{Binding PostDate}"
                                   TextColor="#66696E"/>
                            
                            <BoxView Style="{StaticResource boxViewPoint}"/>

                            <Label Text="{Binding PostTime}"
                                   TextColor="#66696E"/>

                        </StackLayout>

                    </StackLayout>

                    <BoxView Style="{StaticResource boxViewSeparator}"/>
                    
                </Grid>


            </DataTemplate>

            <DataTemplate x:Key="OwlGifTemplate">

                <Grid Margin="10">

                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="70" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="1" />
                    </Grid.RowDefinitions>

                    <ffimageloading:CachedImage Source="{Binding AuthorAvatar}"
                                                Style="{StaticResource ImageAvatarStyle}">

                        <ffimageloading:CachedImage.Transformations>

                            <fftransformations:CircleTransformation/>

                        </ffimageloading:CachedImage.Transformations>

                    </ffimageloading:CachedImage>

                    <StackLayout Grid.Row="0"
                                 Grid.Column="1"
                                 Margin="0, 10, 0, 0">

                        <Label Text="{Binding AuthorNickName}"
                               TextColor="#02060E"
                               FontSize="Large"/>

                        <Label Text="{Binding Text}"
                               TextColor="#02060E"/>

                        <ffimageloading:CachedImage Source="{Binding Gif}"
                                                    HeightRequest="250"
                                                    Margin="0, 0, 10, 0"
                                                    IsEnabled="True"
                                                    LoadingPlaceholder="loading...">
                            
                            <ffimageloading:CachedImage.Transformations>

                                <fftransformations:CornersTransformation CornersTransformType="AllRounded"
                                                                         BottomLeftCornerSize="5"
                                                                         TopLeftCornerSize="5"
                                                                         BottomRightCornerSize="5"
                                                                         TopRightCornerSize="5"/>

                            </ffimageloading:CachedImage.Transformations>
                        </ffimageloading:CachedImage>

                        <StackLayout Orientation="Horizontal">

                            <Label Text="{Binding PostDate}"
                                   TextColor="#66696E"/>

                            <BoxView Style="{StaticResource boxViewPoint}"/>

                            <Label Text="{Binding PostTime}"
                                   TextColor="#66696E"/>

                        </StackLayout>

                    </StackLayout>

                    <BoxView Style="{StaticResource boxViewSeparator}"/>

                </Grid>

            </DataTemplate>

            <DataTemplate x:Key="OwlVideoTemplate">

                <Grid Margin="10">

                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="70" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="1" />
                    </Grid.RowDefinitions>

                    <ffimageloading:CachedImage Source="{Binding AuthorAvatar}"
                                                Style="{StaticResource ImageAvatarStyle}">

                        <ffimageloading:CachedImage.Transformations>

                            <fftransformations:CircleTransformation/>

                        </ffimageloading:CachedImage.Transformations>

                    </ffimageloading:CachedImage>

                    <StackLayout Grid.Row="0"
                                 Grid.Column="1"
                                 Margin="0, 10, 0, 0">

                        <Label Text="{Binding AuthorNickName}"
                               TextColor="#02060E"
                               FontSize="Large"/>

                        <Label Text="{Binding Text}"
                               TextColor="#02060E"/>

                        <videoplayer:VideoPlayer Source="{Binding Video}"
                                                 HeightRequest="250"
                                                 AutoPlay="False"
                                                 DisplayControls="True" />

                        <StackLayout Orientation="Horizontal">

                            <Label Text="{Binding PostDate}"
                                   TextColor="#66696E"/>

                            <BoxView Style="{StaticResource boxViewPoint}"/>

                            <Label Text="{Binding PostTime}"
                                   TextColor="#66696E"/>

                        </StackLayout>

                    </StackLayout>

                    <BoxView Style="{StaticResource boxViewSeparator}"/>

                </Grid>
                
            </DataTemplate>

            <local:OwlTemplateSelector x:Key="OwlTemplateSelector"
                                       OwlOneImageTemplate="{StaticResource OwlOneImageTemplate}"
                                       OwlFewImageTemplate="{StaticResource OwlFewImageTemplate}"
                                       OwlAlbumTemplate="{StaticResource OwlAlbumTemplate}"
                                       OwlNoMediaTemplate ="{StaticResource OwlNoMediaTemplate}"
                                       OwlGifTemplate ="{StaticResource OwlGifTemplate}"
                                       OwlVideoTemplate ="{StaticResource OwlVideoTemplate}"/>
        </ResourceDictionary>
        
    </views:BaseContentPage.Resources>

    <Grid Margin="20">
    
        <Grid.RowDefinitions>
            <RowDefinition Height="48"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <CollectionView Grid.Row="1"
                        ItemsSource="{Binding Owls}"
                        ItemTemplate="{StaticResource OwlTemplateSelector}"
                        ItemsUpdatingScrollMode="KeepItemsInView"/>

    </Grid>

</views:BaseContentPage>
